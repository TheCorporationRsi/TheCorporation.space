<script>

function add_department() {
    var x = document.getElementById("influence_transfer");

    $.ajax({
        url: '/api/departments?' + jQuery.param({ 
            department_title: "Exploration", 
            department_color : "green"
        }),
        type: 'POST',
        success: function (response) {
            alert("Exploration added")
        },
        error: function (xhr) {
            //Do Something to handle error
        }
        
    }); 

}

function add_division(department_id) {
    var x = document.getElementById("influence_transfer");

    $.ajax({
        url: '/api/divisions?' + jQuery.param({ 
            division_title: "Prospecting", 
            division_color : "green",
            division_motto : "lol",
            department_id : "bb939234-35ee-4513-8d17-477a0a357681"
        }),
        type: 'POST',
        success: function (response) {
            alert("Prospecting added")
        },
        error: function (xhr) {
            //Do Something to handle error
        }
        
    }); 

}

function submit_department_form(e) {
    var frm = $('#department_creation_form');
    $.ajax({
        type: frm.attr('method'),
        url: "/dashboard/modules/admin/add_department",
        data: frm.serialize(),
        success: function (response) {
            $("#department_creation").html(response);

        }
    });

}

function submit_division_form(e) {
    var frm = $('#division_creation_form');
    $.ajax({
        type: frm.attr('method'),
        url: "/dashboard/modules/admin/add_division",
        data: frm.serialize(),
        success: function (response) {
            $("#division_creation").html(response);

            department_autocomplete()
        }
    });

}

function get_division_form(e) {
    $.ajax({
        type: "get",
        url: "/dashboard/modules/admin/add_division",
        data: { jsdata: 0 },
        success: function (response) {
            $("#division_creation").html(response);

            department_autocomplete()
        }
    });

}


function department_autocomplete() {
    var departments = [];
    
            function loadUsers() {
                $.getJSON('/api/departments', function (data, status, xhr) {
                    for (var i = 0; i < data.length; i++) {
                        departments.push(data[i].title);
                    }
                });
            };

            loadUsers();

            $('#division-department_title').autocomplete({
                source: departments,
            });
}





</script>


<div id="department_creation" class="module" >
    <script type="text/javascript">
        get_module($('#department_creation'),'/dashboard/modules/admin/add_department')
    </script>
</form>

</div>

<div id="division_creation" class="module" >
    <script type="text/javascript">
        get_division_form()
    </script>
</form>



