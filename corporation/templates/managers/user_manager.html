{% extends "managers/structure_manager.html" %}



{% block page %}
<div class="radio-menu">

    {% if current_user.is_manager("admin") %}
    {% if currentdep == 0 %}
    <input onclick="window.location='{{ url_for('managers.role_manager') }}'" label="All" type="radio" name="department"
        checked>
    {% else %}
    <input onclick="window.location='{{ url_for('managers.role_manager') }}'" label="All" type="radio"
        name="department">
    {% endif %}
    {% endif %}

    {% for department in departments %}
    {% if current_user.is_manager(department = department.id) %}
    {% if currentdep == department.id %}
    <input onclick="window.location='{{ url_for('managers.role_manager', department= department.id) }}';"
        label="{{ department.title }}" type="radio" name="department" checked>
    {% else %}
    <input onclick="window.location='{{ url_for('managers.role_manager', department= department.id) }}';"
        label="{{ department.title }}" type="radio" name="department">
    {% endif %}
    {% else %}
    {% for division in department.divisions %}
    {% if current_user.is_manager(division = division.id) %}
    {% if currentdep == department.id %}
    <input
        onclick="window.location='{{ url_for('managers.role_manager', department= department.id, division= division.id) }}';"
        label="{{ department.title }}" type="radio" name="department" checked>
    {% else %}
    <input
        onclick="window.location='{{ url_for('managers.role_manager', department= department.id, division= division.id) }}';"
        label="{{ department.title }}" type="radio" name="department">
    {% endif %}
    {% endif %}
    {% endfor %}

    {% endif %}
    {% endfor %}
</div>

<div class="radio-menu">

    {% if current_user.is_manager("admin") or current_user.is_manager(department = currentdep) %}
    {% if currentdiv == 0 %}
    <input onclick="window.location='{{ url_for('managers.role_manager', department = currentdep) }}'" label="All"
        type="radio" name="division" checked>
    {% else %}
    <input onclick="window.location='{{ url_for('managers.role_manager', department = currentdep) }}'" label="All"
        type="radio" name="division">
    {% endif %}
    {% endif %}

    {% for division in divisions %}
    {% if currentdep == 0 or currentdep == division.department.id %}
    {% if current_user.is_manager(division = division.id) %}
    {% if currentdiv == division.id %}
    <input
        onclick="window.location='{{ url_for('managers.role_manager', department = division.department.id , division = division.id) }}';"
        label="{{ division.title }}" type="radio" name="division" checked>
    {% else %}
    <input
        onclick="window.location='{{ url_for('managers.role_manager', department = division.department.id , division = division.id) }}';"
        label="{{ division.title }}" type="radio" name="division">
    {% endif %}
    {% endif %}
    {% endif %}
    {% endfor %}
</div>

<div class="list-title">
    <h1>Users list :</h1>
</div>

<div class="list">
    {% for user in users %}


    <div class="user-item">
        <img style=" height: 50px; width: 50px;" src="{{ user.image_file }}">
        <a href="">{{ user.RSI_handle }}</a>
        <a href="javascript:void(0);" onclick="show_user_dropdown('{{ user.RSI_handle }}')">
            <div class="mobile-button">
                <img style=" height: 35px; width: 35px;" src="/static/main/ham.png">
            </div>
        </a>
        <div id="{{ user.RSI_handle }}" class="user-dropdown">
            <div class="roles">
                {% for role in user.roles() %}
                <div style=" border-color: {{ role.color }}; ">
                    <p class="circle" style="background-color: {{ role.color }};"></p>
                    {{ role.title }}
                </div>
                {% endfor %}
            </div>

            <ul class="new-role-list" role="menu">
                {% for role in roles %}
                {% if not user.has_role(role) %}
                <li><a href="{{ url_for('managers.add_role', user = user.id, role = role.id,  next=request.url) }}">{{role.title }}</a>
                </li>
                {% endif %}
                {% endfor %}

            </ul>
        </div>
    </div>


    {% else %}
    <p>No role found</p>
    {% endfor %}

</div>
{% endblock page %}