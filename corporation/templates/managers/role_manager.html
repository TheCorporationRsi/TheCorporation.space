{% extends "managers/structure_manager.html" %}



{% block page %}

<div class="radio-menu">

    {% if current_user.is_manager("admin") %}
    {% if currentdep == 0 %}
    <input onclick="window.location='{{ url_for('managers.role_manager') }}'" label="All" type="radio" name="department"
        checked>
    {% else %}
    <input onclick="window.location='{{ url_for('managers.role_manager') }}'" label="All" type="radio"
        name="department">
    {% endif %}
    {% endif %}

    {% for department in departments %}
    {% if current_user.is_manager(department = department.id) %}
    {% if currentdep == department.id %}
    <input onclick="window.location='{{ url_for('managers.role_manager', department= department.id) }}';"
        label="{{ department.title }}" type="radio" name="department" checked>
    {% else %}
    <input onclick="window.location='{{ url_for('managers.role_manager', department= department.id) }}';"
        label="{{ department.title }}" type="radio" name="department">
    {% endif %}
    {% else %}
    {% for division in department.divisions %}
    {% if current_user.is_manager(division = division.id) %}
    {% if currentdep == department.id %}
    <input
        onclick="window.location='{{ url_for('managers.role_manager', department= department.id, division= division.id) }}';"
        label="{{ department.title }}" type="radio" name="department" checked>
    {% else %}
    <input
        onclick="window.location='{{ url_for('managers.role_manager', department= department.id, division= division.id) }}';"
        label="{{ department.title }}" type="radio" name="department">
    {% endif %}
    {% endif %}
    {% endfor %}

    {% endif %}
    {% endfor %}
</div>

<div class="radio-menu">

    {% if current_user.is_manager("admin") or current_user.is_manager(department = currentdep) %}
    {% if currentdiv == 0 %}
    <input onclick="window.location='{{ url_for('managers.role_manager', department = currentdep) }}'" label="All"
        type="radio" name="division" checked>
    {% else %}
    <input onclick="window.location='{{ url_for('managers.role_manager', department = currentdep) }}'" label="All"
        type="radio" name="division">
    {% endif %}
    {% endif %}

    {% for division in divisions %}
    {% if currentdep == 0 or currentdep == division.department.id %}
    {% if current_user.is_manager(division = division.id) %}
    {% if currentdiv == division.id %}
    <input
        onclick="window.location='{{ url_for('managers.role_manager', department = division.department.id , division = division.id) }}';"
        label="{{ division.title }}" type="radio" name="division" checked>
    {% else %}
    <input
        onclick="window.location='{{ url_for('managers.role_manager', department = division.department.id , division = division.id) }}';"
        label="{{ division.title }}" type="radio" name="division">
    {% endif %}
    {% endif %}
    {% endif %}
    {% endfor %}
</div>

<div class="add-form">

    <form method="POST" action="">
        {{ form.hidden_tag() }}
        <fieldset class="form-group">
            <div class="form-group">
                {{ form.title.label(class="title")}}
                {% if form.title.errors %}
                {{ form.title(class="error")}}
                <div class="invalid-feedback">
                    {% for error in form.title.errors %}
                    <span>{{ error }}</span>
                    {% endfor %}
                </div>
                {% else %} {{ form.title()}} {%
                endif %}
            </div>
        </fieldset>
        <div class="form-group">{{ form.submit()}}</div>
    </form>
</div>

<div class="list-title">
    <h1>Role list :</h1>
</div>

<div class="list">
    {% for role in roles %}


    <div class="item">
        <a href="">{{ role.title }}</a>
        <small class="" style="color: rgb(231, 231, 231) !important">
            User count: {{ role.member_count() }}</small>
    </div>

    {% else %}
    <p>No role found</p>
    {% endfor %}

</div>


{% endblock page %}