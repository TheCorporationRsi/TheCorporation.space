{% extends "discord_bot/discord_setup_template.html" %}



{% block page %}

<div class="radio-menu">

    {% if current_user.is_manager("admin") %}
    {% if currentdep == 0 %}
    <input onclick="window.location='{{ url_for('managers.role_manager') }}'" label="All" type="radio" name="department"
        checked>
    {% else %}
    <input onclick="window.location='{{ url_for('managers.role_manager') }}'" label="All" type="radio"
        name="department">
    {% endif %}
    {% endif %}

    {% for department in department_list %}
    {% if current_user.is_manager(department = department.id) %}
    {% if currentdep == department.id %}
    <input onclick="window.location='{{ url_for('managers.role_manager', department= department.id) }}';"
        label="{{ department.title }}" type="radio" name="department" checked>
    {% else %}
    <input onclick="window.location='{{ url_for('managers.role_manager', department= department.id) }}';"
        label="{{ department.title }}" type="radio" name="department">
    {% endif %}
    {% else %}
    {% for division in department.divisions %}
    {% if current_user.is_manager(division = division.id) %}
    {% if currentdep == department.id %}
    <input
        onclick="window.location='{{ url_for('managers.role_manager', department= department.id, division= division.id) }}';"
        label="{{ department.title }}" type="radio" name="department" checked>
    {% else %}
    <input
        onclick="window.location='{{ url_for('managers.role_manager', department= department.id, division= division.id) }}';"
        label="{{ department.title }}" type="radio" name="department">
    {% endif %}
    {% endif %}
    {% endfor %}

    {% endif %}
    {% endfor %}
</div>

<div class="radio-menu">

    {% if current_user.is_manager("admin") or current_user.is_manager(department = currentdep) %}
    {% if currentdiv == 0 %}
    <input onclick="window.location='{{ url_for('managers.role_manager', department = currentdep) }}'" label="All"
        type="radio" name="division" checked>
    {% else %}
    <input onclick="window.location='{{ url_for('managers.role_manager', department = currentdep) }}'" label="All"
        type="radio" name="division">
    {% endif %}
    {% endif %}

    {% for division in division_list %}
    {% if currentdep == 0 or currentdep == division.department.id %}
    {% if current_user.is_manager(division = division.id) %}
    {% if currentdiv == division.id %}
    <input
        onclick="window.location='{{ url_for('managers.role_manager', department = division.department.id , division = division.id) }}';"
        label="{{ division.title }}" type="radio" name="division" checked>
    {% else %}
    <input
        onclick="window.location='{{ url_for('managers.role_manager', department = division.department.id , division = division.id) }}';"
        label="{{ division.title }}" type="radio" name="division">
    {% endif %}
    {% endif %}
    {% endif %}
    {% endfor %}
</div>

<div class="list-title">
    <h1>Role list :</h1>
</div>

<div class="list">
    {% for role in roles %}

    <div class="item">
        <form method="POST" action="">
            {{ update_form.csrf_token }}
            {{ update_form.role_id(value= role.id|string )}}

            <div class="title" style="color: {{role.role_color()}}">{{role.title}}</div>
            {% if update_form.discord_id.errors %}

            {{ update_form.discord_id(class="error", value=role.discord_id )}}
            <div class="invalid-feedback">
                {% for error in update_form.discord_id.errors %}
                <span>{{ error }}</span>
                {% endfor %}
            </div>

            {% else %}

            {{ update_form.discord_id( value=role.discord_id )}}

            {% endif %}

            {{ update_form.update(style="margin-left: auto; margin-right: none;")}}
        </form>
    </div>

    {% else %}
    <p>No role found</p>
    {% endfor %}

</div>


{% endblock page %}